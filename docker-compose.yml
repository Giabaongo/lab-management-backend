version: '3.8'

services:
  # API Application - Kết nối đến Azure SQL Database
  api:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: lab-management-api-prod
    ports:
      - "8080:80"
    environment:
      - ASPNETCORE_ENVIRONMENT=Production
      # Azure SQL Database v2 - LabManagementDB_v2
      - ConnectionStrings__DefaultConnection=server=bao-sql-server.database.windows.net; database=LabManagementDB_v2; uid=giabaongo; pwd=abcd1234@; TrustServerCertificate=False; Trusted_Connection=False;
      # JWT Configuration (có thể override từ Azure App Settings)
      - Jwt__Key=SuperSecretKeyForJwtGenerationSuperSecretKeyForJwtGenerationSuperSecretKeyForJwtGeneration
      - Jwt__Issuer=LabManagementAPI
      - Jwt__Audience=LabManagementUsers
    restart: unless-stopped
    networks:
      - lab-network

networks:
  lab-network:
    driver: bridge